# Variáveis
RESOURCE_GROUP="rg-java-vm"
VM_NAME="java-vm"
LOCATION="brazilsouth"
IMAGE="almalinux:almalinux-x86_64:9-gen2:9.2.2023072701"
ADMIN_USER="azureuser"
ADMIN_PASSWORD="Fiap@2tdsvms"
VM_SIZE="Standard_B1ms"
OS_DISK_SIZE=30  # GiB

# 1. Criar grupo de recursos
az group create --name $RESOURCE_GROUP --location $LOCATION

# 2. Criar a máquina virtual com HDD Standard (30 GiB)
az vm create \
  --resource-group $RESOURCE_GROUP \
  --name $VM_NAME \
  --image $IMAGE \
  --authentication-type password \
  --admin-username $ADMIN_USER \
  --admin-password $ADMIN_PASSWORD \
  --size $VM_SIZE \
  --storage-sku Standard_LRS \
  --os-disk-size-gb $OS_DISK_SIZE \
  --output json

# 3. Abrir portas 22 (SSH) e 8080 (para a aplicação)
az vm open-port --resource-group $RESOURCE_GROUP --name $VM_NAME --port 22
az vm open-port --resource-group $RESOURCE_GROUP --name $VM_NAME --port 8080
